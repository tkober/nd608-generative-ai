A Community-Developed List of Software & Hardware Weakness Types Cross-site scripting (XSS) vulnerabilities occur when:  There are three main kinds of XSS:  Once the malicious script is injected, the attacker can perform a variety of malicious activities. The attacker could transfer private information, such as cookies that may include session information, from the victim's machine to the attacker. The attacker could send malicious requests to a web site on behalf of the victim, which could be especially dangerous to the site if the victim has administrator privileges to manage that site. Phishing attacks could be used to emulate trusted web sites and trick the victim into entering a password, allowing the attacker to compromise the victim's account on that web site. Finally, the script could exploit a vulnerability in the web browser itself possibly taking over the victim's machine, sometimes referred to as "drive-by hacking."  In many cases, the attack can be launched without the victim even being aware of it. Even with careful users, attackers frequently use a variety of methods to encode the malicious portion of the attack, such as URL encoding or Unicode, so the request looks less suspicious.  The same origin policy states that browsers should limit the resources accessible to scripts running on a given web site, or "origin", to the resources associated with that web site on the client-side, and not the client-side resources of any other sites or "origins". The goal is to prevent one site from being able to modify or read the contents of an unrelated site. Since the World Wide Web involves interactions between many sites, this policy is important for browsers to enforce. The Domain of a website when referring to XSS is roughly equivalent to the resources associated with that website on the client-side of the connection. That is, the domain can be thought of as all resources the browser is storing for the user's interactions with this particular site. Languages  Class: Language-Independent  (Undetermined Prevalence) Technologies  Class: Web Based  (Often Prevalent) Technical Impact:  Bypass Protection Mechanism; Read Application Data Technical Impact:  Execute Unauthorized Code or Commands Technical Impact:  Execute Unauthorized Code or Commands; Bypass Protection Mechanism; Read Application Data Example 1 This code displays a welcome message on a web page based on the HTTP GET username parameter. This example covers a Reflected XSS (Type 1) scenario. Because the parameter can be arbitrary, the url of the page could be modified so $username contains scripting syntax, such as This results in a harmless alert dialog popping up. Initially this might not appear to be much of a vulnerability. After all, why would someone enter a URL that causes malicious code to run on their own computer? The real danger is that an attacker will create the malicious URL, then use e-mail or social engineering tricks to lure victims into visiting a link to the URL. When victims click the link, they unwittingly reflect the malicious content through the vulnerable web application back to their own computers. More realistically, the attacker can embed a fake login box on the page, tricking the user into sending the user's password to the attacker: If a user clicks on this link then Welcome.php will generate the following HTML and send it to the user's browser: The trustworthy domain of the URL may falsely assure the user that it is OK to follow the link. However, an astute user may notice the suspicious text appended to the URL. An attacker may further obfuscate the URL (the following example links are broken into multiple lines for readability): The same attack string could also be obfuscated as: Both of these attack links will result in the fake login box appearing on the page, and users are more likely to ignore indecipherable text at the end of URLs. Example 2 This example also displays a Reflected XSS (Type 1) scenario. The following JSP code segment reads an employee ID, eid, from an HTTP request and displays it to the user. The following ASP.NET code segment reads an employee ID number from an HTTP request and displays it to the user. The code in this example operates correctly if the Employee ID variable contains only standard alphanumeric text. If it has a value that includes meta-characters or source code, then the code will be executed by the web browser as it displays the HTTP response. Example 3 This example covers a Stored XSS (Type 2) scenario. The following JSP code segment queries a database for an employee with a given ID and prints the corresponding employee's name. The following ASP.NET code segment queries a database for an employee with a given employee ID and prints the name corresponding with the ID. This code can appear less dangerous because the value of name is read from a database, whose contents are apparently managed by the application. However, if the value of name originates from user-supplied data, then the database can be a conduit for malicious content. Without proper input validation on all data stored in the database, an attacker can execute malicious commands in the user's web browser. Example 4 The following example consists of two separate pages in a web application, one devoted to creating user accounts and another devoted to listing active users currently logged in. It also displays a Stored XSS (Type 2) scenario. CreateUser.php The code is careful to avoid a SQL injection attack ( CWE-89 ) but does not stop valid HTML from being stored in the database. This can be exploited later when ListUsers.php retrieves the information:  ListUsers.php The attacker can set their name to be arbitrary HTML, which will then be displayed to all visitors of the Active Users page. This HTML can, for example, be a password stealing Login message. Example 5 Consider an application that provides a simplistic message board that saves messages in HTML format and appends them to a file.  When a new user arrives in the room, it makes an announcement: An attacker may be able to perform an HTML injection (Type 2 XSS) attack by setting a cookie to a value like: The raw contents of the message file would look like: For each person who visits the message page, their browser would execute the script, generating a pop-up window that says "Hacked". More malicious attacks are possible; see the rest of this entry. Phase:  Architecture and Design Strategy:  Libraries or Frameworks Phases:  Implementation; Architecture and Design Phases:  Architecture and Design; Implementation Strategy:  Attack Surface Reduction Effectiveness: Limited Phase:  Architecture and Design Phase:  Architecture and Design Strategy:  Parameterization Phase:  Implementation Strategy:  Output Encoding Phase:  Implementation Phase:  Implementation Strategy:  Attack Surface Reduction Effectiveness: Defense in Depth Phase:  Implementation Strategy:  Input Validation Phase:  Architecture and Design Strategy:  Enforcement by Conversion Phase:  Operation Strategy:  Firewall Effectiveness: Moderate Phases:  Operation; Implementation Strategy:  Environment Hardening  Automated Static Analysis Effectiveness: Moderate  Black Box Effectiveness: Moderate Applicable Platform XSS flaws are very common in web applications, since they require a great deal of developer discipline to avoid them. Relationship There can be a close relationship between XSS and CSRF ( CWE-352 ). An attacker might use CSRF in order to trick the victim into submitting requests to the server in which the requests contain an XSS payload. A well-known example of this was the Samy worm on MySpace [ REF-956 ]. The worm used XSS to insert malicious HTML sequences into a user's profile and add the attacker as a MySpace friend. MySpace friends of that victim would then execute the payload to modify their own profiles, causing the worm to propagate exponentially. Since the victims did not intentionally insert the malicious script themselves, CSRF was a root cause.  Use of the Common Weakness Enumeration (CWE) and the associated references from this website are subject to the  Terms of Use . CWE is sponsored by the  U.S. Department of Homeland Security  (DHS)  Cybersecurity and Infrastructure Security Agency  (CISA) and managed by the  Homeland Security Systems Engineering and Development Institute  (HSSEDI) which is operated by  The MITRE Corporation  (MITRE). Copyright Â© 2006-2021, The MITRE Corporation. CWE, CWSS, CWRAF, and the CWE logo are trademarks of The MITRE Corporation.